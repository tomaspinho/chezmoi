{{ if eq .chezmoi.os "linux" -}}
#!/bin/bash

if hash apt 2>/dev/null; then
  sudo apt install --yes {{ range .packages.apt }}{{ . | quote }} {{ end }}
fi

if hash pacman 2>/dev/null; then
  sudo pacman -Sy --needed {{ range .packages.pacman }}{{ . | quote }} {{ end }}
fi

if hash yay 2>/dev/null; then
  echo y | LANG=C yay -Sy --answerdiff None --answerclean None --mflags "--noconfirm" {{ range .packages.yay }}{{ . | quote }} {{ end }}
fi

if ! hash mise 2>/dev/null; then
  echo "Did not find mise in PATH, installing..."
  mkdir -p ~/.local/bin
  curl https://mise.jdx.dev/mise-latest-linux-x64 > ~/.local/bin/mise
  chmod +x ~/.local/bin/mise
  echo "Done."
fi
{{ end -}}
